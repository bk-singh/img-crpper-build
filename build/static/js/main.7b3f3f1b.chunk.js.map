{"version":3,"sources":["ListCroppedImage.js","ListUploadedImage.js","Cropper.js","App.js","serviceWorker.js","index.js"],"names":["Canvas","styled","canvas","ListCroppedImage","data","showCroppedFile","map","i","hidden","key","width","height","id","className","Img","img","ListUploadedImage","url","src","alt","Container","div","Button","button","Cropper","useState","file","setFile","base64Data","setBase64Data","responseData","setResponseData","setShowCroppedFile","showUploadedFile","setShowUploadedFile","sx","sy","sWidth","sHeight","x","y","handleOnClick","crop","base64","forEach","push","document","getElementById","concat","image","Image","getContext","drawImage","toDataURL","drawCroppedImg","uploadImage","images","a","fetch","method","headers","Accept","body","JSON","stringify","imgs","type","onClick","length","alert","then","response","json","catch","error","accept","onChange","e","blobSrc","URL","createObjectURL","target","files","setTimeout","value","App","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","navigator","serviceWorker","ready","registration","unregister","console","message"],"mappings":"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","file":"static/js/main.7b3f3f1b.chunk.js","sourcesContent":["import React from \"react\";\nimport styled from \"styled-components\";\n\nconst Canvas = styled.canvas`\n  margin: 20px;\n`;\n\nfunction ListCroppedImage({ data, showCroppedFile }) {\n  return (\n    <div>\n      {[0, 1, 2, 3].map((i) => (\n        <div hidden={!showCroppedFile} key={i + 100}>\n          <h3\n            key={i + 1000}\n          >{`Cropped Image: ${data[i].width} x ${data[i].height}`}</h3>\n          <Canvas id={`img-canvas-${i}`} key={i} className=\"canvas\" />\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default ListCroppedImage;\n","import React from \"react\";\nimport styled from \"styled-components\";\n\nconst Img = styled.img`\n  margin: 20px;\n`;\n\nfunction ListUploadedImage({ data }) {\n  return (\n    <div>\n      {data.map((img, i) => {\n        const { url } = img;\n        return (\n          <div key={i + 10}>\n            <Img key={i} src={url} alt={url} />\n            <h5 key={i + 100}>{url}</h5>\n            <br key={i + 1000} />\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n\nexport default ListUploadedImage;\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport ListCroppedImage from \"./ListCroppedImage\";\nimport ListUploadedImage from \"./ListUploadedImage\";\n\nconst Container = styled.div`\n  margin: 50px;\n  padding: 30px;\n  border: 1px solid grey;\n`;\n\nconst Button = styled.button`\n  background-color: lightblue;\n  padding: 10px;\n  margin: 20px;\n`;\n\nfunction Cropper() {\n  const [file, setFile] = useState(null);\n  const [base64Data, setBase64Data] = useState([]);\n  const [responseData, setResponseData] = useState([]);\n  const [showCroppedFile, setShowCroppedFile] = useState(false);\n  const [showUploadedFile, setShowUploadedFile] = useState(false);\n\n  const data = [\n    {\n      sx: 0,\n      sy: 0,\n      sWidth: 755,\n      sHeight: 450,\n      x: 0,\n      y: 0,\n      width: 755,\n      height: 450,\n    },\n    {\n      sx: 755,\n      sy: 0,\n      sWidth: 212,\n      sHeight: 365,\n      x: 0,\n      y: 0,\n      width: 212,\n      height: 365,\n    },\n    {\n      sx: 0,\n      sy: 450,\n      sWidth: 365,\n      sHeight: 450,\n      x: 0,\n      y: 0,\n      width: 365,\n      height: 450,\n    },\n    {\n      sx: 356,\n      sy: 450,\n      sWidth: 380,\n      sHeight: 480,\n      x: 0,\n      y: 0,\n      width: 380,\n      height: 380,\n    },\n  ];\n\n  const onFileChange = (e) => {\n    const blobSrc = URL.createObjectURL(e.target.files[0]);\n    let image = new Image();\n    image.src = blobSrc;\n    setTimeout(() => {\n      if (image.width !== 1024 && image.height !== 1024) {\n        alert(\"Image should be exactly 1024 x 1024.\");\n        const fileInput = document.getElementById(\"upload-file\");\n        fileInput.value = \"\";\n        return;\n      }\n      setFile(image.src);\n    }, 1000);\n  };\n\n  const drawCroppedImg = (i, img, crop) => {\n    const canvas = document.getElementById(\"\".concat(\"img-canvas-\", i));\n    if (!canvas) return;\n    let image = new Image();\n    image.src = img;\n    canvas.width = crop.width;\n    canvas.height = crop.height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(\n      image,\n      data[i].sx,\n      data[i].sy,\n      data[i].sWidth,\n      data[i].sHeight,\n      data[i].x,\n      data[i].y,\n      data[i].width,\n      data[i].height\n    );\n    return canvas.toDataURL(\"image/jpeg\", 1.0);\n  };\n\n  const handleOnClick = (img, crop) => {\n    let base64 = [];\n    [0, 1, 2, 3].forEach((i) =>\n      base64.push(\n        drawCroppedImg(i, img, {\n          width: data[i].width,\n          height: data[i].height,\n        })\n      )\n    );\n    setShowCroppedFile(true);\n    setBase64Data(base64);\n  };\n  const uploadImage = async (images) => {\n    const url = \"/api/base64/images\";\n    return await fetch(url, {\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        imgs: images,\n      }),\n    });\n  };\n\n  const onUpload = () => {\n    if (!base64Data && !base64Data.length) {\n      return alert(\"Error uploading images\");\n    }\n\n    uploadImage(base64Data)\n      .then((response) => response.json())\n      .then((response) => {\n        setResponseData(response.data);\n        setShowUploadedFile(true);\n      })\n      .catch((error) => {\n        alert(error);\n      });\n  };\n\n  return (\n    <Container>\n      {showUploadedFile ? (\n        <div>\n          <h3>Uploaded Images</h3>\n          <ListUploadedImage data={responseData} />\n        </div>\n      ) : (\n        <div hidden={!showCroppedFile}>\n          <Button type=\"primary\" onClick={onUpload}>\n            Upload Cropped Images\n          </Button>\n          <ListCroppedImage data={data} showCroppedFile={showCroppedFile} />\n        </div>\n      )}\n      {!showCroppedFile && (\n        <div>\n          <h2>Crop Image</h2>\n          <span>Upload a file: </span>\n          <input\n            id=\"upload-file\"\n            type=\"file\"\n            accept=\"image/*\"\n            onChange={onFileChange}\n          />\n          {file && (\n            <div>\n              <Button\n                type=\"primary\"\n                onClick={() =>\n                  handleOnClick(file, { width: 1024, height: 1024 })\n                }\n              >\n                View Cropped Images\n              </Button>\n              <br />\n              <h4>Original Image (1024 x 1024)</h4>\n              <div>\n                <img id=\"img-uploaded\" src={file} alt=\"original\" />\n              </div>\n              <br />\n            </div>\n          )}\n        </div>\n      )}\n    </Container>\n  );\n}\n\nexport default Cropper;\n","import React from \"react\";\nimport \"./App.css\";\nimport Cropper from \"./Cropper\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Cropper />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}